<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>포지션 매칭 페이지</title>
<script src="https://code.jquery.com/jquery-3.7.1.js"
	integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
	crossorigin="anonymous"></script>
</head>
<body>
	<h1>포지션 매칭 리스트</h1>
	<hr>
	
	<input type="hidden" name="username">
	<table border="1">
		<thead>
			<tr>
				<th>이름</th>
				<th>이력서 제목</th>
				<th>포지션 제안</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td></td>
				<td></td>
				<td><button type="button" value="포지션 제안하기" onclick="goPositionDetail()"></button></td>
			<tr>
		</tbody>
	</table>
	
	
	<script>
	document.addEventListener('DOMContentLoaded', (event) => {
	    // localstorage에서 username 가져오기 (지금은 세션에 없으니까 주석처리) 나중에 세션에서 가져오는 걸로 수정하기
	    // let username = localStorage.getItem('username');
	    let username1 = "com1"; // 여기에 실제 username 값을 설정. 실제로는 session에서 가져오기.
	    localStorage.setItem('username', username1); // localStorage에 username저장
	    
	    let username = localStorage.getItem('username');
	    
	    console.log("로컬스토리지에서 얻어온 username = " + username);
	    
	    $.ajax({
	        type: "GET",
	        url: "http://localhost:9002/com/getPositionList",
	        headers: {
	            "Username": username
	        },
	        success: function(response) {
	            console.log(response);
	            
	            response.forEach(function(resume2) {
	                console.log(resume2.user.uname);
	                console.log(resume2.rtitle);
	                //resume2.user.username input hidden에 넣기
	                
	            }); // forEach 괄호 추가
	            
	        },
	        error: function(error) {
	            console.error("에러 발생:", error);
	        } // error 함수 괄호 추가
	    });
	});
	
	
	function goPositionDetail(){
		
		// 페이지 이동 코드 넣기
		// 이동할때 username 들고가기
		// 파라미터
		// 컨트롤러에서 model에 넣어서 전달하기
		
	}
	</script>
</body>
</html>