<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="https://code.jquery.com/jquery-3.7.1.js"
	integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
	crossorigin="anonymous"></script>
</head>

<body>
<header>
	<div th:replace="~{/fragments/comHeader.html}"></div>
</header>

	<!-- <p>Session Username: <span th:text="${session.username}"></span></p> -->
	<h1>기업 마이페이지</h1>
	<hr>
	<h3>기업 정보조회</h3>
	<table border="1">
		<thead>
			<tr>
				<th>기업명</th>
				<th>로고</th>
				<th>대표자명</th>
				<th>기업주소</th>
				<th>사원수</th>
				<th>기업규모</th>
				<th>주요사업</th>
				<th>연매출액</th>
				<th>업종</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td id="cname"></td>
				<td><img th:src="@{/images/하이브 로고.png}" alt="기업로고" width="400"
					height="200"></td>
				<td id="ceo"></td>
				<td id="caddr"></td>
				<td id="employees"></td>
				<td id="size"></td>
				<td id="major"></td>
				<td id="yrSales"></td>
				<td id="sector"></td>
			</tr>
		</tbody>
	</table>
	<input type="submit" value="기업 정보 수정하기" onclick="updateComp(event)">
	<script>
	
		

		
		
		$(document).ready(function(){
			
			const username = localStorage.getItem('username');
			console.log(username);
			
			$.ajax({
				url: 'http://localhost:9002/com/getCompanyInfo/'+ username,
				method: 'GET',
				success: function(response){
					$('#cname').text('기업명: ' + response.cname);
					$('#ceo').text('대표자 명: ' + response.ceo);
					$('#caddr').text('회사주소: ' + response.caddr);
					$('#employees').text('사원 수: ' + response.employees);
					$('#size').text('기업규모: ' + response.size);
					$('#major').text('주요사업: ' + response.major);
					$('#yrSales').text('연매출액: ' + response.yrSales);
					$('#sector').text('업종: ' + response.sector);
				},
				error: function(error){
					console.log("Error: " + error);
				}
			});
		});
		
		
		function updateComp(event) {

			event.preventDefault();
			alert("기업 정보 수정페이지로 이동합니다");

			$
					.ajax({
						type : "GET",
						url : "http://localhost:9002/com/getCompanyInfo",
						headers : {

							"Username" : username
						},
						
						success : function(data) {
							
							console.log("데이터 조회 성공:", data);
							
							window.location.href = 'http://localhost:8094/com/toCompanyUpdate';
						
						},
						error : function(xhr, status, error) {
							console.log("에러 발생:", error);
							// 에러 발생시 처리할 내용을 추가할 수 있습니다.
						}
					});
		}
	</script>
</body>

</html>